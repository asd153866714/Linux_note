 # 上課內容
 
 ### 系統行程管理
 
 * `ps -f` 觀察行程狀態
 
 * `ps -aux | more 更詳細
 
    * Centos 7 PID=1 => systemd
    * Centos 7 PID=1 => init
 
 * `ps -ef` 更詳細
 
 * `pstree` 行程關係圖
 * `free` 觀察系統資源
 
 ### top
 
 * 互動式行程觀察工具
 * 進階版 => htop (yum 安裝)
 
    * 圖形量表可觀察: CPU% MEM% SWP%

### 背景行程

* `指令 &` 放到背景執行

 * `sleep 60 &`
 * `(sleep 60 &)` 終端機關掉後行程還存在

* Ctrl + z => 暫停

  * `bg` 放到背景執行
  
* `jobs` 觀察背景、前景行程
* `fg [編號]` 取回前景

### 優先權
* nice value (NI)

  * 編號 -20 ~ 19，數字越低優先權最高
  * Centos 預設 0
  * `ps l` 顯示 NI
  * `nice -n -3 sleep 60 &` 指定 NI 為 3
  * `renice -7 PID` 調整 NI 為 

* priority (PRI)

  * 預設為 0
  * 最終 PRI值 = 初始 PRI + NI 

* 實務: 使用電腦時，調低吃資源的行程的優先權，不用電腦時，則相反

### 刪除行程
* `kill PID` 刪除行程
* `kill -9 PID` 強制刪除 (Zombie)
* `killall 名稱` 刪除所有相同名稱
* `pkill 名稱` 同上

 ### 行程資訊目錄 /proc
 * cd, ls, cat 操作
 
* 路由器功能：
```
// 若是顯示1.表示路遊功能開啟
// 若是顯示0,表示路由功能關閉
cat /proc/sys/net/ipv4/ip_forward
1

// 開啟
echo 1 > /proc/sys/net/ipv4/ip_forward
```

* `cat /proc/cpuinfo` 顯示linux中cpu資訊
* `cat /proc/meminof` 顯示mem資訊
 
 # 補充
 * `python -m SimpleHTTPServer 80` "-m" Python 模組， 建立網頁伺服器
 
 * 假設 80 port 已被占用 :

   1. `ps -aux | grep 名稱`
   2. `kill PID`
    
# sed
* `sed -i '' passwd` -i 套用結果
* `sed -n '' passwd` -n 顯示結果，但不會改變內容

### 新增
1. `'i//'` => insert 插入在 pattern 行之前
2. `'a//'` => add 插入在 pattern 行之後

`sed -i '/^dhcpd/a xxxxxxxx ooooo' passwd` a 插入在 pattern 行之後

`sed -i '/^dhcpd/i Hello World' passwd` i 是插入在 pattern 行之前

### 刪除
* `'//d'`

`sed -i '30,/^sssd/d' passwd` 30行 ~ ^sssd 開頭的行

`sed -i '/^usbmuxd/,/^tcpdump/d' passwd`

### 修改
* `'s///'` => 's/ 匹配 / 取代 / flag'

  * flag 空白 => 取代第一個匹配到的
  * flag 為 g => 取代全部
  
```
[root@centos7 ~]# cat -n passwd | grep root
1 root❌0:0:root:/root:/bin/bash
10 operator❌11:0:operator:/root:/sbin/nologin

[root@centos7 ~]# sed -i 's/root/ROOT/' passwd
[root@centos7 ~]# cat -n passwd | grep root
1 ROOT❌0:0:root:/root:/bin/bash

[root@centos7 ~]# cat -n passwd | grep root
1 ROOT❌0:0:root:/root:/bin/bash

[root@centos7 ~]# sed -i 's/root/ROOT/g' passwd
[root@centos7 ~]# cat -n passwd | grep root
[root@centos7 ~]# cat -n passwd | grep ROOT
1 ROOT❌0:0:ROOT:/ROOT:/bin/bash
```
